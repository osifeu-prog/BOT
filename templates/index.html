<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Diamond Elite Arcade</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { background: #0a0a0c; color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; text-align: center; }
        .gold-btn { background: linear-gradient(45deg, #bf953f, #fcf6ba); color: #000; border: none; padding: 15px; border-radius: 12px; font-weight: 900; width: 80%; margin: 10px; cursor: pointer; }
        .card { background: #16161a; border: 1px solid #bf953f; border-radius: 20px; padding: 20px; margin: 15px; box-shadow: 0 0 20px rgba(191,149,63,0.2); }
        canvas { background: #5c94fc; border-radius: 15px; width: 90%; height: 200px; margin: 10px 0; border: 3px solid #333; }
    </style>
</head>
<body>
    <div class="card">
        <h2 style="margin:0;">DIAMOND <span style="color:#bf953f;">ELITE</span></h2>
        <div id="bal" style="font-size: 32px; font-weight: 900; color:#bf953f;">---</div>
        <div style="font-size: 12px; opacity: 0.6;">CURRENT SLH BALANCE</div>
    </div>

    <div class="card">
        <h3> RETRO MARIO</h3>
        <canvas id="gameCanvas"></canvas>
        <button class="gold-btn" onclick="startGame()">PLAY & EARN</button>
    </div>

    <button class="gold-btn" style="background: #222; color: #fff; border: 1px solid #444;" onclick="dailySpin()"> DAILY ROULETTE</button>

    <script>
        let tg = window.Telegram.WebApp;
        let userId = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "12345";
        
        async function load() {
            const r = await fetch('/api/user/' + userId);
            const d = await r.json();
            document.getElementById('bal').innerText = d.slh.toLocaleString();
        }

        // Game Logic Simple
        let canvas = document.getElementById('gameCanvas');
        let ctx = canvas.getContext('2d');
        function startGame() {
            Swal.fire('Coming Soon', '注 专驻  注...', 'info');
        }

        async function dailySpin() {
            tg.HapticFeedback.impactOccurred('heavy');
            Swal.fire({ title: '住转...', timer: 1500, didOpen: () => Swal.showLoading() }).then(async () => {
                await fetch('/api/save-game-score?user_id=' + userId + '&score=500', {method: 'POST'});
                Swal.fire('转!', '拽转 50 SLH 转 转', 'success');
                load();
            });
        }

        load();
        tg.expand();
    </script>
</body>
</html>
