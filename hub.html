<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #020617; color: white; font-family: sans-serif; margin: 0; text-align: center; }
        .tabs { display: flex; background: #1e1b4b; position: sticky; top: 0; z-index: 10; }
        .tab { flex: 1; padding: 15px; cursor: pointer; opacity: 0.6; }
        .tab.active { opacity: 1; border-bottom: 3px solid #6366f1; font-weight: bold; }
        .content { padding: 20px; display: none; }
        .content.active { display: block; }
        .card { background: #111827; border-radius: 20px; padding: 25px; border: 1px solid #1e293b; margin-top: 20px; }
        .balance-text { font-size: 45px; color: #6366f1; font-weight: 800; margin: 10px 0; }
        .btn { background: #6366f1; color: white; border: none; padding: 15px; width: 100%; border-radius: 12px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body onload="loadData()">
    <div class="tabs">
        <div class="tab active" onclick="show('wallet', this)">ğŸ’³ ××¨× ×§</div>
        <div class="tab" onclick="show('games', this)">ğŸ•¹ï¸ ××¨×§×™×™×“</div>
    </div>

    <div id="wallet" class="content active">
        <div class="card">
            <p>×™×ª×¨×” ×–××™× ×”</p>
            <div class="balance-text" id="walletBal">...</div>
            <button class="btn" onclick="alert('×”×¢×‘×¨×•×ª ×¤×¢×™×œ×•×ª ×“×¨×š ×”-API')">ğŸ’¸ ×”×¢×‘×¨×” ××”×™×¨×”</button>
        </div>
    </div>

    <div id="games" class="content">
        <div class="card">
            <h2>ğŸ•¹ï¸ DIAMOND ARCADE</h2>
            <div id="slotEmoji" style="font-size: 80px; margin: 20px;">ğŸ’</div>
            <p>×¢×œ×•×ª: 50 SLH</p>
            <button class="btn" id="spinBtn" onclick="play()">×¡×•×‘×‘ ×¢×›×©×™×•!</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const uid = tg.initDataUnsafe.user.id;

        async function loadData() {
            const res = await fetch('/api/user_data/' + uid);
            const data = await res.json();
            document.getElementById('walletBal').innerText = data.balance.toLocaleString() + ' SLH';
        }

        async function play() {
            const btn = document.getElementById('spinBtn');
            btn.disabled = true;
            const res = await fetch('/api/play_arcade', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: uid})
            });
            const result = await res.json();
            if(result.status === 'success') {
                document.getElementById('slotEmoji').style.transform = 'scale(1.2)';
                setTimeout(() => {
                    document.getElementById('slotEmoji').style.transform = 'scale(1)';
                    alert(result.win ? 'ğŸ† ×–×›×™×ª ×‘-150 SLH!' : 'ğŸ˜¢ ××•×œ×™ ×‘×¤×¢× ×”×‘××”...');
                    loadData();
                    btn.disabled = false;
                }, 500);
            } else { alert(result.message); btn.disabled = false; }
        }

        function show(id, el) {
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            el.classList.add('active');
        }
    </script>
</body>
</html>
