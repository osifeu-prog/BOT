<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Diamond Elite Arcade</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --gold: #fcf6ba; --dark: #0a0a0c; }
        body { background: var(--dark); color: #fff; font-family: -apple-system, blinkmacsystemfont, 'Segoe UI'; margin: 0; overflow: hidden; }
        .balance-box { background: linear-gradient(135deg, #16161a 0%, #25252b 100%); border: 1px solid #bf953f; padding: 20px; border-radius: 20px; margin: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .game-area { width: 90%; height: 300px; background: #1a1a20; border-radius: 20px; margin: 0 auto; position: relative; overflow: hidden; border: 2px solid #333; }
        .btn-play { background: linear-gradient(45deg, #bf953f, #fcf6ba); color: #000; padding: 15px 40px; border-radius: 50px; font-weight: 900; border: none; font-size: 18px; margin-top: 20px; box-shadow: 0 5px 15px rgba(191,149,63,0.4); }
    </style>
</head>
<body>
    <div class="balance-box">
        <div style="opacity: 0.6; font-size: 12px; letter-spacing: 1px;">MY DIAMOND BALANCE</div>
        <div id="balance" style="font-size: 36px; font-weight: 900; color: var(--gold);">---</div>
    </div>
    
    <div class="game-area" id="gameArea">
        <div id="mario" style="width:40px; height:40px; background:red; position:absolute; bottom:0; left:50px; border-radius:5px;"></div>
        <div style="position:absolute; top:40%; width:100%; text-align:center; opacity:0.2; font-size:40px; font-weight:900;">ARCADE</div>
    </div>

    <button class="btn-play" onclick="playDice()" id="actionBtn">×”×˜×œ ×§×•×‘×™×™×ª ×ž×–×œ ðŸŽ²</button>

    <script>
        let tg = window.Telegram.WebApp;
        let userId = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "12345";

        async function load() {
            const r = await fetch('/api/user/' + userId);
            const d = await r.json();
            document.getElementById('balance').innerText = d.slh.toLocaleString() + " SLH";
        }

        async function playDice() {
            tg.HapticFeedback.impactOccurred('heavy');
            document.getElementById('actionBtn').disabled = true;
            
            // ××¤×§×˜ ×§×•× ×¤×˜×™ ×‘×ž×™×“×” ×•×–×•×›×™×
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 }, colors: ['#bf953f', '#fcf6ba'] });
            
            await fetch(/api/game-action?user_id=){userId}&action=dice&amount=10, {method: 'POST'});
            setTimeout(() => {
                load();
                document.getElementById('actionBtn').disabled = false;
            }, 1000);
        }

        load();
        tg.expand();
    </script>
</body>
</html>
