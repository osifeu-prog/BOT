<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Diamond VIP</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { background: #0a0a0c; color: #fff; font-family: system-ui; margin: 0; text-align: center; }
        .gold { color: #bf953f; font-weight: bold; }
        .card { background: #16161a; border: 1px solid #bf953f; border-radius: 20px; padding: 20px; margin: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .game { background: #1c1c22; padding: 20px; border-radius: 15px; border: 1px solid #333; }
        .btn { background: #bf953f; color: #000; border: none; padding: 15px; width: 80%; border-radius: 10px; font-weight: bold; margin: 10px; }
    </style>
</head>
<body>
    <h2 class="gold">DIAMOND VIP ARCADE</h2>
    <div class="card">
        <div style="opacity: 0.6">יתרת יהלומים</div>
        <div id="bal" style="font-size: 30px; font-weight: 900;">---</div>
    </div>

    <div class="card" style="border-style: dashed;">
        <h3 class="gold">🎁 מתנה יומית</h3>
        <button class="btn" onclick="spin()" id="sBtn">סובב את הרולטה</button>
    </div>

    <div class="grid">
        <div class="game" onclick="play()">🎰<br>סלוט</div>
        <div class="game" onclick="tg.openTelegramLink('https://t.me/osifeu_prog')">💬<br>תמיכה</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        let userId = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "123";

        async function load() {
            const r = await fetch('/api/user/' + userId);
            const d = await r.json();
            document.getElementById('bal').innerText = d.slh.toLocaleString();
        }

        async function spin() {
            document.getElementById('sBtn').disabled = true;
            const r = await fetch('/api/daily-spin?user_id=' + userId, {method: 'POST'});
            const d = await r.json();
            Swal.fire(d.win ? 'זכית!' : 'אופס', d.win ? קיבלת  SLH : 'נסה שוב מחר', d.win ? 'success' : 'info');
            load();
        }

        async function play() {
            const r = await fetch(/api/play?user_id=&bet=50, {method: 'POST'});
            const d = await r.json();
            Swal.fire(d.win ? 'JACKPOT!' : 'הפסד', יתרה חדשה: , d.win ? 'success' : 'error');
            load();
        }

        load();
        tg.expand();
    </script>
</body>
</html>