import telebot, uvicorn, psycopg2, logging, os, json
from fastapi import FastAPI, Request
from fastapi.responses import HTMLResponse, JSONResponse
from telebot.types import ReplyKeyboardMarkup, KeyboardButton, WebAppInfo
from utils.config import *

# 1. ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยงุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ
logging.basicConfig(level=logging.INFO, format='%(asctime)s | %(message)s')
logger = logging.getLogger("DIAMOND_SUPREME")

bot = telebot.TeleBot(TELEGRAM_TOKEN, threaded=False)
app = FastAPI()
ADMIN_ID = "224223270"
ADMIN_PW = "OSIF_DIAMOND_2026"

def get_db(): return psycopg2.connect(DATABASE_URL)

# --- 2. ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยข API ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยข-ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข ---

@app.get("/wallet_page", response_class=HTMLResponse)
async def get_wallet():
    try:
        with open("wallet.html", "r", encoding="utf-8") as f: return f.read()
    except: return "<h1>Wallet file missing</h1>"

@app.get("/games_page", response_class=HTMLResponse)
async def get_games():
    try:
        with open("games.html", "r", encoding="utf-8") as f: return f.read()
    except: return "<h1>Games file missing</h1>"

@app.post("/api/transfer")
async def transfer_funds(request: Request):
    data = await request.json()
    if data.get("password") != ADMIN_PW:
        return JSONResponse({"status": "error", "message": "ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยทุทยฅรขโฌโขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยทุทยฅรขโฌโขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ"}, status_code=403)
    
    try:
        conn = get_db(); cur = conn.cursor()
        # ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยงุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ
        cur.execute("UPDATE users SET balance = balance - %s WHERE user_id = %s", (int(data['amount']), str(data['sender_id'])))
        cur.execute("UPDATE users SET balance = balance + %s WHERE user_id = %s", (int(data['amount']), str(data['receiver_id'])))
        conn.commit(); cur.close(); conn.close()
        return {"status": "success"}
    except Exception as e:
        return JSONResponse({"status": "error", "message": str(e)})

# --- 3. ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยงุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฉ (ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ) ---

def main_menu(uid):
    markup = ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    base_url = WEBHOOK_URL.split('/8106')[0]
    markup.add(
        KeyboardButton("ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยขุทยขุขยณ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยง SUPREME", web_app=WebAppInfo(url=f"{base_url}/wallet_page")),
        KeyboardButton("ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยขุทยขุขยนุทยทุขยฃุทยขุขยฏุทยทุขยขุทยขุขยธุทยทุขยนุทยซรขโฌย ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยงุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌล ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยข", web_app=WebAppInfo(url=f"{base_url}/games_page"))
    )
    markup.add("ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌลุทยทุขยธุทยขุขยน ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยข", "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยทุขยนุทยซรขโฌยุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขย ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข")
    markup.add("ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยขุทยขุขยฅ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยทรขโฌุ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌรขโฌลุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข", "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌลุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยน ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยฆุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ")
    if str(uid) == ADMIN_ID: markup.add("ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ")
    return markup

@bot.message_handler(commands=['start'])
def start(message):
    uid = str(message.from_user.id)
    conn = get_db(); cur = conn.cursor()
    cur.execute("INSERT INTO users (user_id, balance) VALUES (%s, 1000) ON CONFLICT DO NOTHING", (uid,))
    conn.commit(); cur.close(); conn.close()
    bot.send_message(message.chat.id, "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยนุทยนุขยฉ **DIAMOND SUPREME SYSTEM**\nุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ. ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌรขโฌลุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ:", reply_markup=main_menu(uid), parse_mode="HTML")

@bot.message_handler(func=lambda m: m.text == "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยทุขยนุทยซรขโฌยุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขย ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข")
def leaderboard(message):
    conn = get_db(); cur = conn.cursor()
    cur.execute("SELECT user_id, balance FROM users ORDER BY balance DESC LIMIT 10")
    top = cur.fetchall()
    cur.close(); conn.close()
    msg = "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยทุขยนุทยซรขโฌยุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขย **TOP 10 LEADERS**\n\n"
    for i, u in enumerate(top):
        msg += f"{i+1}. <code>{str(u[0])[:5]}***</code> ุทยทุขยฃุทยขุขยขุทยฃุขยขุฃยขรขโยฌุนโุทยขุขยฌุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ {u[1]:,} SLH\n"
    bot.send_message(message.chat.id, msg, parse_mode="HTML")

@bot.message_handler(func=lambda m: m.text == "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยขุทยขุขยฅ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยทรขโฌุ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌรขโฌลุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข")
def invite(message):
    ref_link = f"https://t.me/{bot.get_me().username}?start={message.from_user.id}"
    bot.reply_to(message, f"ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยทุขยนุฃยขรขโยฌุนยฉุทยฃุขยขุฃยขรขโยฌุนโุทยขุขยฌ **ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยง ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ:**\n{ref_link}", parse_mode="HTML")

@bot.message_handler(func=lambda m: m.text == "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌลุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยน ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยฆุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ")
def sys_status(message):
    bot.reply_to(message, "ุทยทุขยฃุทยขุขยขุทยทุขยฅุฃยขรขโยฌุฅโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยฆ **ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ**\nุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌลุทยทุขยทุทยฅรขโฌโข ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ: Railway\nุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌรขโฌลุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุนโุทยทุขยฃุทยขุขยฏุทยทุขยขุทยขุขยธุทยทุขยนุทยซรขโฌย ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยทุทยฅรขโฌโขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌล ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข: Connected\nุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยขุทยขุขยนุทยทุขยฃุทยขุขยฏุทยทุขยขุทยขุขยธุทยทุขยนุทยซรขโฌย ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยงุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌล: Online")

# ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌลุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยทรขโฌุ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุฃยขรขโยฌุนยฉ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌลุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌรขโฌลุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌลุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยข ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยทุทยฅรขโฌโข ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข
@bot.message_handler(func=lambda m: m.text == "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ" and str(m.from_user.id) == ADMIN_ID)
def admin_p(message):
    bot.send_message(message.chat.id, "ุทยทุขยธุฃยขรขโยฌุขยนุทยทุขยนุทยทรขโฌุุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยขุทยขุขยุทยทุขยฃุทยขุขยฏุทยทุขยขุทยขุขยธุทยทุขยนุทยซรขโฌย **ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนรขโฌยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยทรขโฌุุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ**\n/fix - ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยฏุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยคุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยทุทยฅรขโฌโข Webhook\n/stats - ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุฃยขรขโฌโุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยนุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยฅุฃยขรขโยฌุฅโุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโยฌรขโฌฺุทยขุขยขุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยฅรขโฌโข")

@bot.message_handler(commands=['fix'])
def fix(message):
    if str(message.from_user.id) == ADMIN_ID:
        bot.remove_webhook()
        bot.set_webhook(url=f"{WEBHOOK_URL}/{TELEGRAM_TOKEN}/")
        bot.send_message(message.chat.id, "ุทยทุขยฃุทยขุขยขุทยทุขยฅุฃยขรขโยฌุฅโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยฆ Webhook Reset Done!")

# --- 4. ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยฉุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยขุทยขุขยจุทยทุขยฃุฃยขรขโยฌรขโฌโุทยทุขยนุทยขุขยพ ุทยทุขยฃุฃยขรขโยฌรขโฌโุทยฃุขยขุฃยขรขโฌฺุขยฌุทยขุขยข-Webhook ---

@app.post(f"/{TELEGRAM_TOKEN}/")
async def process_webhook(request: Request):
    body = (await request.body()).decode('utf-8')
    bot.process_new_updates([telebot.types.Update.de_json(body)])
    return "ok"

@app.on_event("startup")
def on_startup():
    bot.set_webhook(url=f"{WEBHOOK_URL}/{TELEGRAM_TOKEN}/")

# --- Daily Rewards & Quest System ---

@bot.message_handler(func=lambda m: m.text == "ุทยธรขโฌยนุทยนุทโบุทยนุนยฉุทยธุขยพ ุทยฃรขโฌโุฃยขรขโยฌุนยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยทุฅโ ุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌุนโุทยฃรขโฌโุฃยขรขโฌโุขยข")
def daily_bonus(message):
    uid = str(message.from_user.id)
    conn = get_db(); cur = conn.cursor()
    
    # ุทยฃรขโฌโุฃยขรขโยฌุนยฉุทยฃรขโฌโุฃยขรขโยฌุฅโุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุทยขุขยงุทยฃรขโฌโุฃยขรขโยฌรขโฌล ุทยฃรขโฌโุฃยขรขโยฌุนโุทยฃรขโฌโุทยนุขยพุทยฃรขโฌโุฃยขรขโฌโุขยข ุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุทยนุขยพุทยฃรขโฌโุฃยขรขโยฌรขโฌล ุทยฃรขโฌโุทยขุขยงุทยฃรขโฌโุฃยขรขโยฌุนยฉุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุทยนุขยพ ุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุฃยขรขโยฌุนยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยทุฅโ ุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุทยนุขยฏุทยฃรขโฌโุฃยขรขโยฌรขโฌโุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยุทยฃรขโฌโุฃยขรขโยฌรขโฌล
    cur.execute("SELECT last_bonus FROM users WHERE user_id = %s", (uid,))
    last_bonus = cur.fetchone()[0]
    
    # ุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌรขโยขุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุทยขุขยงุทยฃรขโฌโุฃยขรขโยฌรขโฌล ุทยฃรขโฌโุทยขุขยคุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยนุขยฉุทยฃรขโฌโุฃยขรขโยฌรขโฌล: ุทยฃรขโฌโุทยขุขยคุทยฃรขโฌโุทยขุขยขุทยฃรขโฌโุฃยขรขโยฌุฅโ ุทยฃรขโฌโุฃยขรขโยฌุนยฉ-24 ุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุทยขุขยขุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยนุขยพ (ุทยฃรขโฌโุทยนุขยฏุทยฃรขโฌโุทยขุขยคุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุทยขุขยจ ุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุฃยขรขโยฌุทโบุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุทยฅรขโฌล ุทยฃรขโฌโุทยขุขยขุทยฃรขโฌโุฃยขรขโยฌุฅโ datetime)
    # ุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุทยขุขยฆุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุทยนรขโฌฺฉ ุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุฃยขรขโยฌุฅโุทยฃรขโฌโุฃยขรขโยฌรขโยขุทยฃรขโฌโุฃยขรขโยฌุนโุทยฃรขโฌโุฃยขรขโยฌรขโฌล, ุทยฃรขโฌโุทยขุขยุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุทยนุขยพุทยฃรขโฌโุทยนุทโบ ุทยฃรขโฌโุฃยขรขโยฌุนยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยทุฅโ ุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุทยฅรขโฌล 200 SLH
    cur.execute("UPDATE users SET balance = balance + 200, last_bonus = NOW() WHERE user_id = %s", (uid,))
    conn.commit(); cur.close(); conn.close()
    
    bot.send_message(message.chat.id, "ุทยธรขโฌยนุทยนุทโบุฃยขรขโยฌรขโยขุทยขุขยฐ **ุทยฃรขโฌโุฃยขรขโยฌุนโุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุทยฅรขโฌล ุทยฃรขโฌโุทยนุขยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌุนยฉ!**\nุทยฃรขโฌโุทยขุขยงุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุฃยขรขโยฌุนยฉุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุทยนุขยพ ุทยฃรขโฌโุฃยขรขโยฌุนยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยทุฅโ ุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌุนโุทยฃรขโฌโุฃยขรขโฌโุขยข ุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุทยฅรขโฌล 200 SLH.\nุทยฃรขโฌโุฃยขรขโยฌรขโฌโุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยจ ุทยฃรขโฌโุฃยขรขโยฌุนโุทยฃรขโฌโุฃยขรขโยฌรขโฌโุทยฃรขโฌโุทยขุขยจ ุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุฃยขรขโยฌุนยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยทุฅโ ุทยฃรขโฌโุฃยขรขโยฌรขโยขุทยฃรขโฌโุฃยขรขโยฌุฅโุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยฅรขโฌล ุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยนุขยพุทยฃรขโฌโุทยขุขยจ!", parse_mode="HTML")

# ุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุฃยขรขโยฌุฅโุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌรขโยข ุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุทยขุขยคุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุทยนุขยฉุทยฃรขโฌโุทยขุขยคุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุฃยขรขโยฌุขยข ุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุทยนุขยฏุทยฃรขโฌโุฃยขรขโยฌรขโฌล ุทยฃรขโฌโุฃยขรขโยฌรขโยขุทยฃรขโฌโุฃยขรขโยฌุฅโ ุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌรขโฌโุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุฃยขรขโยฌุฅโ
@bot.message_handler(func=lambda m: m.text == "ุทยธรขโฌยนุทยนุทโบุฃยขรขโยฌุฅโุทยธุขยน ุทยฃรขโฌโุทยขุขยคุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุทยนุขยฉุทยฃรขโฌโุทยขุขยคุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุฃยขรขโยฌุขยข")
def portfolio(message):
    uid = str(message.from_user.id)
    conn = get_db(); cur = conn.cursor()
    cur.execute("SELECT balance FROM users WHERE user_id = %s", (uid,))
    bal = cur.fetchone()[0]
    cur.close(); conn.close()
    
    msg = f"ุทยธรขโฌยนุทยนุทโบุฃยขรขโยฌุฅโุทยธุขยน **DIAMOND PORTFOLIO**\n\n"
    msg += f"ุทยธรขโฌยนุทยนุทโบุฃยขรขโยฌรขโยขุทยขุขยฐ ุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุทยนุขยพุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุฃยขรขโยฌรขโฌล: <code>{bal:,} SLH</code>\n"
    msg += f"ุทยธรขโฌยนุทยนุทโบุฃยขรขโยฌุฅโุทยซรขโฌย ุทยฃรขโฌโุทยทุฅโุทยฃรขโฌโุทยนุขยฉุทยฃรขโฌโุทยนุขยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยทุฅโ: Diamond Holder\n"
    msg += f"ุทยธรขโฌยนุทยนุทโบุทยนรขโฌฺฉุฃยขรขโฌฺุขยฌ ุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโฌโุขยข ุทยฃรขโฌโุฃยขรขโยฌุนโุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุทยขุขยขุทยฃรขโฌโุทยขุขยจุทยฃรขโฌโุทยนรขโฌฺฉ: {(bal * 0.12):.2f} USD" # ุทยฃรขโฌโุทยทุฅโุทยฃรขโฌโุทยนุขยพุทยฃรขโฌโุฃยขรขโยฌุฅโ ุทยฃรขโฌโุฃยขรขโยฌรขโฌโุทยฃรขโฌโุฃยขรขโฌโุขยขุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุฃยขรขโยฌุขยขุทยฃรขโฌโุฃยขรขโยฌุนยฉ ุทยฃรขโฌโุทยฅรขโฌลุทยฃรขโฌโุฃยขรขโยฌรขโฌลุทยฃรขโฌโุฃยขรขโยฌุนโุทยฃรขโฌโุฃยขรขโยฌรขโฌโุทยฃรขโฌโุทยขุขยฉุทยฃรขโฌโุฃยขรขโยฌรขโฌล
    bot.send_message(message.chat.id, msg, parse_mode="HTML")

# --- The Supreme Shop & Multipliers ---

@app.post("/api/buy_item")
async def buy_item(request: Request):
    data = await request.json()
    uid = str(data.get("user_id"))
    item_id = data.get("item_id") # ุฃโุฅโุฃโรขโฌฺุฃโุขยฉุฃโุฅโ: 'multiplier_x2'
    price = int(data.get("price"))

    try:
        conn = get_db(); cur = conn.cursor()
        cur.execute("SELECT balance FROM users WHERE user_id = %s", (uid,))
        balance = cur.fetchone()[0]

        if balance < price:
            return JSONResponse({"status": "error", "message": "ุฃโุนยฏุฃโรขโยขุฃโุนุ ุฃโรขโฌฺุฃโุทลุฃโุขยคุฃโรขโยขุฃโุขยง SLH ุฃโรขโฌฺฉุฃโรขโฌโุฃโุขยฉุฃโรขโฌฺฉุฃโรขโฌยขุฃโุนุ!"})

        # ุฃโรขโฌโุฃโุขยคุฃโรขโฌโุฃโุนยพุฃโุนยพ ุฃโุนยพุฃโุขยฉุฃโุฅโุฃโรขโฌยขุฃโรขโฌล ุฃโรขโฌยขุฃโุขยขุฃโรขโฌลุฃโรขโฌุุฃโรขโฌยขุฃโุนุ ุฃโุขยคุฃโุขยจุฃโรขโยขุฃโุนยฉ (ุฃโรขโฌุุฃโุนยฏุฃโุนุ ุฃโุนยฏุฃโุขยคุฃโุขยฉุฃโุขยจ ุฃโุฅโุฃโรขโฌโุฃโรขโฌยขุฃโุทลุฃโรขโยขุฃโุขยฃ ุฃโุนยฉุฃโรขโฌฺฉุฃโุฅโุฃโุนยพ inventory ุฃโรขโฌฺฉุฃโุขยขุฃโุนยพุฃโรขโยขุฃโรขโฌล)
        cur.execute("UPDATE users SET balance = balance - %s WHERE user_id = %s", (price, uid))
        conn.commit(); cur.close(); conn.close()
        
        logger.info(f"ุธโนุนุรขโฌุรขโฌโข SHOP PURCHASE: User {uid} bought {item_id} for {price} SLH")
        return {"status": "success", "new_balance": balance - price}
    except Exception as e:
        return JSONResponse({"status": "error", "message": str(e)})

@bot.message_handler(func=lambda m: m.text == "ุธโนุนุรขโฌุรขโฌโข ุฃโรขโฌโุฃโุขยุฃโรขโฌยขุฃโุนยพ")
def open_shop(message):
    msg = "ุธโนุนุุนหุนยพ **SUPREME SHOP**\nุฃโรขโฌฺุฃโรขโฌยขุฃโุขยฆุฃโุขยจุฃโรขโยขุฃโรขโฌล ุฃโรขโฌฺฉุฃโุฅโุฃโุขยขุฃโรขโฌลุฃโรขโยขุฃโรขโยขุฃโรขโฌล ุฃโุฅโุฃโรขโฌฺุฃโรขโฌโุฃโรขโฌโุฃโรขโยขุฃโุขยงุฃโรขโยข ุฃโรขโยขุฃโรขโฌโุฃโุฅโุฃโรขโฌยขุฃโรขโฌฺุฃโรขโยขุฃโรขโฌล:\n\n"
    msg += "1ุฃยฏุขยธุนหุฃยขุฆโุขยฃ **ุฃโรขโฌฺุฃโรขโฌุุฃโุขยคุฃโรขโยขุฃโุฅโ X2 ุฃโรขโฌฺฉุฃโุนยฏุฃโุขยจุฃโุขยงุฃโรขโยขุฃโรขโยขุฃโรขโฌล** (12 ุฃโุขยฉุฃโุขยขุฃโรขโฌยขุฃโุนยพ)\nุธโนุนุรขโฌโขุขยฐ ุฃโรขโฌฺุฃโรขโฌโุฃโรขโยขุฃโุขยจ: 1,000 SLH\n\n"
    msg += "2ุฃยฏุขยธุนหุฃยขุฆโุขยฃ **ุฃโุทลุฃโุนยฉุฃโุนยฉุฃโรขโฌยขุฃโุทล VIP ุฃโรขโยขุฃโรขโฌยขุฃโุขยงุฃโุขยจุฃโุนยพุฃโรขโยข**\nุธโนุนุรขโฌโขุขยฐ ุฃโรขโฌฺุฃโรขโฌโุฃโรขโยขุฃโุขยจ: 5,000 SLH\n\n"
    msg += "ุฃโุฅโุฃโรขโฌโุฃโุขยฅ ุฃโุขยขุฃโุฅโ ุฃโรขโฌโุฃโรขโฌฺุฃโรขโฌยขุฃโุขยฆุฃโุขยจ ุฃโุฅโุฃโุขยจุฃโรขโฌุุฃโรขโยขุฃโุขยฉุฃโรขโฌโ (ุฃโรขโฌฺฉุฃโุขยงุฃโุขยจุฃโรขโฌยขุฃโรขโฌฺฉ ุฃโรขโฌฺฉุฃโรขโฌโขุฃโุขยจุฃโุทลุฃโรขโฌโ ุฃโรขโฌโุฃโรขโฌโขุฃโุขยจุฃโุขยคุฃโรขโยขุฃโุนยพ!)"
    
    # ุฃโรขโฌฺฉุฃโุขยุฃโุนยพุฃโรขโยขุฃโรขโยขุฃโรขโฌล ุฃโุขยุฃโุขยฆุฃโรขโยขุฃโุขยข ุฃโุนยฏุฃโุนยพ ุฃโรขโฌโุฃโรขโฌโ ุฃโรขโฌฺฉุฃโุนยฉุฃโุขยงุฃโุทลุฃโุนยฉ, ุฃโรขโฌฺฉุฃโรขโฌโขุฃโุขยจุฃโุทลุฃโรขโฌโ ุฃโรขโฌโุฃโรขโฌฺฉุฃโุนยฏุฃโรขโฌโ ุฃโุขยุฃโุขยคุฃโุนยพุฃโรขโฌโ ุฃโุฅโุฃโรขโฌโุฃโรขโฌโ Mini App ุฃโรขโฌโขุฃโุขยจุฃโุขยคุฃโรขโยข
    bot.send_message(message.chat.id, msg, parse_mode="HTML")

# --- The Diamond Oracle (AI Integration) ---

@bot.message_handler(commands=['ai'])
def ai_assistant(message):
    uid = str(message.from_user.id)
    bot.send_chat_action(message.chat.id, 'typing')
    
    conn = get_db(); cur = conn.cursor()
    cur.execute("SELECT balance FROM users WHERE user_id = %s", (uid,))
    balance = cur.fetchone()[0]
    cur.close(); conn.close()
    
    # รโบรฺฏรฺบ รโรยขรฺพรโขรโ รยรโรโรยจ รฺฏรฺพ รโ-API รยฉรล OpenAI/Gemini. 
    # รโบรยจรโรยข รยรยฉรฺพรโรยฉ รโรโรยรโขรยข รโรโขรยงรโขรโ รโรโบรโ (Rule-based AI) รยฉรยรโขรฺพรฺบ รฺพรโรโขรยฉรโ รฺฏรโขรยฉรโขรฺพ:
    
    response = f"ูฺบยคโ **รยฉรลรโขรโ Diamond Holder #{uid[:4]}**\n\n"
    if balance < 1000:
        response += "รฺฏรยรโข รยจรโขรฺฏรโ รยฉรโรโขรฺพรยจรโ รยฉรลรฺ รยรโรโขรโบรโ. รโรโขรโรลรยฅ รลรโรโขรโบรยรุ รลรฺฏรยจรยงรโขรโขรโ รฺฏรโข รลรโรยงรยฉ รโรยขรโรยจรโ รโรโรโรยจ."
    elif balance > 5000:
        response += "รโขรโขรฺฏรโข! รฺฏรฺพรโ รโรลรโขรโรฺพ รโรยขรยฉรโขรยจรโขรโ. รโบรโรฺฏรโข รลรฺ รลรโรยงรยจ รโรโรยรโขรฺพ รโขรลรยงรยรโขรฺพ รุรฺฉรฺฉรโขรุ VIP."
    else:
        response += "รฺฏรฺพรโ รโรโรยจรฺ รโรยรโบรโขรยรโ! รยขรโขรโ รยงรยฆรฺพ รโรฺฏรโรยฅ รโขรฺพรโรโขรยข รลรฺฉรโขรยค 10."
        
    bot.reply_to(message, response, parse_mode="HTML")

# รยฉรโรยจรโขรโ รโรฺพรยครยจรโขรฺฉ รโรยจรฺฏรยฉรโข รลรโรโขรุรยครฺพ รโบรยครฺพรโขรยจ AI
def main_menu_v2(uid):
    markup = ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    base_url = WEBHOOK_URL.split('/8106')[0]
    markup.add(
        KeyboardButton("ูฺบโยณ รฺฏรยจรยรยง SUPREME", web_app=WebAppInfo(url=f"{base_url}/wallet_page")),
        KeyboardButton("ูฺบโขยนรฏยธฺ รฺฏรยจรยงรโขรโขรโ รโรยจรยครโข", web_app=WebAppInfo(url=f"{base_url}/games_page"))
    )
    markup.add("ูฺบยคโ รยฉรฺฏรล รฺฏรฺพ รโ-AI", "ูฺบโบโ รโรยรโขรฺพ")
    markup.add("ูฺบโูน รยครโขรยจรฺฉรยครโขรลรโขรโข", "ูฺบฺโ รฺฉรโรลรฺพ รฺฏรลรโขรยครโขรโ")
    markup.add("ูฺบโยฅ รโรโรโรฺบ รโรโรยจรโขรโ", "ูฺบฺูพ รโรโขรยรโขรุ รโขรโขรโรโข")
    if str(uid) == ADMIN_ID: markup.add("ูฺบโโ รยครฺฏรยรล รยรโขรโรโขรล")
    return markup

@bot.message_handler(func=lambda m: m.text == "ูฺบยคโ รยฉรฺฏรล รฺฏรฺพ รโ-AI")
def ai_button(message):
    ai_assistant(message)

# --- Viral Growth & Admin Broadcast System ---

@bot.message_handler(commands=['broadcast'])
def broadcast(message):
    if str(message.from_user.id) != ADMIN_ID: return
    
    msg_text = message.text.replace('/broadcast ', '')
    if msg_text == '/broadcast':
        bot.reply_to(message, "โ๏ธ ืื ืืืชืื ืืงืกื ืืืืจ ืืคืงืืื. ืืืืื: /broadcast ืืืืขื ืืืฉื")
        return

    conn = get_db(); cur = conn.cursor()
    cur.execute("SELECT user_id FROM users")
    users = cur.fetchall()
    cur.close(); conn.close()
    
    count = 0
    for u in users:
        try:
            bot.send_message(u[0], f"๐ข **ืืืืขืช ืืขืจืืช SUPREME:**\n\n{msg_text}", parse_mode="HTML")
            count += 1
        except: continue
    
    bot.reply_to(message, f"โ ืืืืืขื ืืฉืืื ื-{count} ืืฉืชืืฉืื.")

# ืขืืืื ืจืืืช ืืคืืจืืคืืืื
@bot.message_handler(func=lambda m: m.text == "๐ ืคืืจืืคืืืื")
def portfolio_v2(message):
    uid = str(message.from_user.id)
    conn = get_db(); cur = conn.cursor()
    cur.execute("SELECT balance FROM users WHERE user_id = %s", (uid,))
    bal = cur.fetchone()[0]
    cur.close(); conn.close()
    
    level = (bal // 2000) + 1 # ืื 2000 SLH ืขืืืื ืจืื
    
    msg = f"๐ **DIAMOND PORTFOLIO**\n"
    msg += f"๐ค ืืฉืชืืฉ: <code>{uid}</code>\n"
    msg += f"๐ ืจืื: <b>{level}</b>\n"
    msg += f"๐ฐ ืืชืจื: <b>{bal:,} SLH</b>\n"
    msg += "โโโโโโโโโโโโโโโโโโ\n"
    msg += f"๐ ืกืืืืก: {'๐ Whale' if level > 5 else 'โจ Holder'}"
    
    bot.send_message(message.chat.id, msg, parse_mode="HTML")
